[phases.setup]
nixPkgs = ["nodejs_20", "python312", "python312Packages.pip"]

[phases.install]
cmds = [
    "cd frontend && npm ci",
    "cd backend && python3 -m pip install -r requirements.txt --target=/app/backend/vendor"
]

[phases.build]
cmds = [
    "cd frontend && npm run build",
    "cp -r frontend/dist backend/static"
]

[start]
cmd = "cd backend && PYTHONPATH=/app/backend/vendor gunicorn app:app"
